# Linux Post Exploitation

## Gathering Additional Information

- `cat /etc/shadow` will show password hashes
- `cat /etc/passwd` will show users in the system
- `cat /etc/issue` will show OS info
- `uname -r` will show kernel information
- `uname -a` will show additional kernel info
- `ps aux` will show the processes running
- `env` will print all env variables

## Metasploit Pos Exploitation Modules

- `linux/gather/enum_configs` will gather all linnux configuration files
- `multi/gather/env` will mostrate environment OS configs
- `linux/gather/enum_network` will enumerate network (ssh/ports/ssh keys/firewall) and other system data
- `linux/gather/enum_protections` will enumerate all active linux protections (iptables, tcpdump/wireshark/Yama)
- `linux/gahter/enum_system` will enumerate the system configs (users/cornjobs/suid files)
- `linux/gater/checkvm` will check if linux is runnning as a VM
- `post/linux/gather/checkcontainer` will check if the machine is runing inside a docker container
- `multi/gather/docker_creds` will dump docker creds
- `linux/gather/enum_users_history` will show all commands lauched by the user
- `linux/gather/hashdump` will dump linux hashes
- `multi/gather/ssh_creds` will loot all ssh keys
- `linux/gather/ecryptfs_creds` will collect contents of all user .ecrypt directories
- `linux/gather/enum_psk`will collect wifi credentials
- `linux/gather/phpmyadmin_credsteal` will gather PhPMyAdmin creds
- `linux/gather/pptpd_chap_secrets` will gather VPN info

## Exploiting a Vulnerable Program

For listing actual running programs `ps aux`

Then check and focus when reviewing the actual runnig script

## Persitence via SSH

- `post/linux/manage/sshkey_persistence` will add a SSH key to an specefied user

## Generatig Persistece on Linux

Generating a new user:

1. `useradd -m <name> -s <shell>` will create a new user
2. `usermod -aG root <username>` will add the new user to ther root group
3. `usermod -u <user_id> <username>` will add an user ID to the user

- `exploit/linux/local/apt_package_manager_persistence` will open a persistence every next APT command is executed
- `exploit/linux/local/autostart_persistence` will execute the persitence every time the device is restarted
- `exploit/linux/local/bash_profile_persistence` will run a persitence when  a bash terminal is launched
- `exploit/linux/local/cron_persistence` will create a cron job